<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BFP Analytics - {{ municipality }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/analytics.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <nav>
            <ul>
                <li><a href="{{ url_for('bfp_dashboard') }}">Dashboard</a></li>
                <li><a href="#" onclick="filterData('today')">Today</a></li>
                <li><a href="#" onclick="filterData('daily')">Daily</a></li>
                <li><a href="#" onclick="filterData('weekly')">Weekly</a></li>
                <li><a href="#" onclick="filterData('monthly')">Monthly</a></li>
                <li><a href="#" onclick="filterData('yearly')">Yearly</a></li>
            </ul>
        </nav>
    </div>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>
        <header>
            <h1>BFP ({{ municipality }}) Fire Incident Reports</h1>
            <p>Barangay: <select id="barangaySelect">
                <option value="">All Barangays</option>
                {% for barangay in barangays %}
                    <option value="{{ barangay }}">{{ barangay }}</option>
                {% endfor %}
            </select></p>
            <p id="datetime">{{ current_datetime }}</p>
            <button class="download-btn" onclick="downloadReport()">DOWNLOAD {{ current_datetime }}</button>
        </header>
        <div class="chart-grid">
            <div class="chart-container"><h2>Incident Trends</h2><canvas id="incidentTrendsChart"></canvas></div>
            <div class="chart-container"><h2>Accident Distribution</h2><canvas id="accidentDistributionChart"></canvas></div>
            <div class="chart-container"><h2>Fire Incident Cause Analysis</h2><canvas id="causeAnalysisChart"></canvas></div>
            <div class="chart-container"><h2>Responded Alerts</h2><canvas id="respondedAlertsChart"></canvas></div>
            <div class="chart-container"><h2>Weather</h2><canvas id="weatherChart"></canvas></div>
            <div class="chart-container"><h2>Property Type</h2><canvas id="propertyTypeChart"></canvas></div>
            <div class="chart-container"><h2>Fire Cause</h2><canvas id="fireCauseChart"></canvas></div>
            <div class="chart-container"><h2>Fire Severity</h2><canvas id="fireSeverityChart"></canvas></div>
            <div class="chart-container"><h2>Casualty Count</h2><canvas id="casualtyCountChart"></canvas></div>
            <div class="chart-container"><h2>Response Time</h2><canvas id="responseTimeChart"></canvas></div>
            <div class="chart-container"><h2>Fire Duration</h2><canvas id="fireDurationChart"></canvas></div>
        </div>
    </main>

    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            sidebar.classList.toggle('active');
            mainContent.classList.toggle('shifted');
        }

        function filterData(timePeriod) {
            fetch(`/api/bfp_analytics_data?time=${timePeriod}`)
                .then(response => response.json())
                .then(data => {
                    updateCharts(data);
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        function updateCharts(data) {
            // Placeholder for chart updates using Chart.js
            // Add logic here to update each chart based on data
        }

        function downloadReport() {
            // Placeholder for report download functionality
            alert('Download functionality to be implemented');
        }
    </script>
</body>
</html>
