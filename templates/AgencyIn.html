<!DOCTYPE html>
<html>
<head>
    <title>Log In Agency</title>
    <link rel="icon" href="{{ url_for('static', filename='logo/alertnow.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
</head>
<body>
    <h1 class="h1">Select Agency To Log In</h1>
    <form class="form2" action="/login_agency" method="post">
        <label>Role: 
            <select name="role" id="role" required class="select-role">
                <option value="cdrrmo">CDRRMO</option>
                <option value="pnp">PNP</option>
                <option value="bfp">BFP</option>
                <option value="health">City Health</option>
                <option value="hospital">Hospital</option>
            </select>
        </label><br>
        <label id="hospital-label" style="display: none;">Assigned Hospital: 
            <select name="assigned_hospital" id="assigned_hospital" class="dropdown-role">
                <option value="SPC District Hospital">SPC District Hospital</option>
                <option value="San Pablo Colleges Medical Center">San Pablo Colleges Medical Center</option>
                <option value="Community General Hospital">Community General Hospital</option>
                <option value="Immaculate Conception Hospital">Immaculate Conception Hospital</option>
                <option value="SPC General Hospital">SPC General Hospital</option>
                <option value="San Pablo Doctors Hospital">San Pablo Doctors Hospital</option>
                <option value="St. Francis and Paul General Hospital">St. Francis and Paul General Hospital</option>
            </select>
        </label><br>
        <label>Assigned Municipality: <input type="text" name="municipality" required></label><br>
        <label>Contact Number: <input type="tel" name="contact_no" required></label><br>
        <label>Password: <input type="password" name="password" required></label><br>
        <button class="button3" type="submit">Log In</button>
        <button class="button4" onclick="window.location.href='/signup_muna'">Sign Up</button>
        <button class="button2" onclick="window.location.href='/choose_login_type'">Choose Account</button>
    </form>
    <form class="form3" action="/auto_role" method="post">
        {% if cdrrmo_pnp_bfp_users %}
            {% for user in cdrrmo_pnp_bfp_users %}
                <div class="role-item" onclick="autoRole('{{ user.role }}', '{{ user.assigned_municipality }}', '{{ user.contact_no }}', '{{ user.password }}', '{{ user.assigned_hospital }}')">
                    {% if user.role == 'hospital' %}
                        {{ user.assigned_hospital|upper }} {{ user.assigned_municipality }}
                    {% else %}
                        {{ user.role|upper }} {{ user.assigned_municipality }}
                    {% endif %}
                </div>
            {% endfor %}
        {% else %}
            <div class="role-item">No CDRRMO/PNP/BFP/City Health/Hospital users found.</div>
        {% endif %}
    </form>
    <script>


        

        function autoRole(role, municipality, contact_no, password, assigned_hospital) {
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = '/auto_role';
            const roleInput = document.createElement('input');
            roleInput.type = 'hidden';
            roleInput.name = 'role';
            roleInput.value = role;
            const municipalityInput = document.createElement('input');
            municipalityInput.type = 'hidden';
            municipalityInput.name = 'municipality';
            municipalityInput.value = municipality;
            const contactInput = document.createElement('input');
            contactInput.type = 'hidden';
            contactInput.name = 'contact_no';
            contactInput.value = contact_no;
            const passwordInput = document.createElement('input');
            passwordInput.type = 'hidden';
            passwordInput.name = 'password';
            passwordInput.value = password;
            
            form.appendChild(roleInput);
            form.appendChild(municipalityInput);
            form.appendChild(contactInput);
            form.appendChild(passwordInput);
            
            document.body.appendChild(form);
            form.submit();
        }

        document.getElementById('role').addEventListener('change', function() {
            const hospitalLabel = document.getElementById('hospital-label');
            if (this.value === 'hospital') {
                hospitalLabel.style.display = 'block';
            } else {
                hospitalLabel.style.display = 'none';
            }
        });
    </script>
</body>
</html>